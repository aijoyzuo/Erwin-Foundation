<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!--meta:vp-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>士兵留聲機</title>
    <meta property="og:description" content="十月十四日為歷史上所載艾爾文的生日，歡迎留下您對他的祝福。" />
    <link rel="icon" href="img/messageboard/icon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/messageboard.css">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.0/animate.min.css' />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!--google字體-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap" rel="stylesheet">

    <!-- CSS 格式修改 -->
    <style>
        /* http://meyerweb.com/eric/tools/css/reset/ 
    v2.0 | 20110126
    License: none (public domain)
 */

        html,
        body,
        div,
        span,
        applet,
        object,
        iframe,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        p,
        blockquote,
        pre,
        a,
        abbr,
        acronym,
        address,
        big,
        cite,
        code,
        del,
        dfn,
        em,
        img,
        ins,
        kbd,
        q,
        s,
        samp,
        small,
        strike,
        strong,
        sub,
        sup,
        tt,
        var,
        b,
        u,
        i,
        center,
        dl,
        dt,
        dd,
        ol,
        ul,
        li,
        fieldset,
        form,
        label,
        legend,
        table,
        caption,
        tbody,
        tfoot,
        thead,
        tr,
        th,
        td,
        article,
        aside,
        canvas,
        details,
        embed,
        figure,
        figcaption,
        footer,
        header,
        hgroup,
        menu,
        nav,
        output,
        ruby,
        section,
        summary,
        time,
        mark,
        audio,
        video {
            margin: 0;
            padding: 0;
            border: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
        }

        /* HTML5 display-role reset for older browsers */
        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        hgroup,
        menu,
        nav,
        section {
            display: block;
        }

        body {
            line-height: 1;
        }

        ol,
        ul {
            list-style: none;
        }

        blockquote,
        q {
            quotes: none;
        }

        blockquote:before,
        blockquote:after,
        q:before,
        q:after {
            content: '';
            content: none;
        }

        table {
            border-collapse: collapse;
            border-spacing: 0;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        .header-bg {
            width: 100%;
            box-shadow: 0 4px 5px rgba(78, 71, 30, 0.8);
            padding-top: 8px;
            background-color: #0a4c72;
        }

        .header {
            max-width: 1000px;
            height: 120px;
            padding: 12px 0px 12px 0px;
            margin: 0 auto;
        }

        h1 {
            font-family: Caption;
            font-weight: 600;
            font-size: 40px;
            color: rgb(255, 255, 255);
            text-shadow: rgba(138, 152, 167, 0.5) 0.1em 0.1em 0.1em;
            margin-top: 8px;
            text-align: center;
            padding: 17px 0px 17px 0px;
            background-image: url("img/messageboard/bluesky2.jpg");
            line-height: 130%;
            letter-spacing: 4px;
        }

        .header p {
            font-family: Caption;
            font-weight: 400;
            font-size: 16px;
            color: #fff;
            text-shadow: rgb(13, 21, 30)0.1em 0.1em 0.5em;
            line-height: 150%;
            padding: 4px 20px 0px 20px;
        }

        .comment-bg,
        .result-bg {
            padding-bottom: 20px;
            background-image: url("img/paperboard4.jpg");
            background-repeat: repeat;

        }

        .comment {
            max-width: 600px;
            height: 360px;
            padding-top: 20px;
            padding-bottom: 20px;
            margin: 0 auto;
        }

        h2 {
            transition: transform 0.6s;
        }

        h2:hover {
            transform: rotateX(360deg);
        }

        .result {
            max-width: 600px;
            padding-top: 20px;
            padding-bottom: 100px;
            margin: 0 auto;
        }

        h2 {
            font-family: Caption;
            font-weight: 600;
            font-size: 26px;
            color: rgb(10, 76, 114);
            background-color: #fff;
            padding: 6px;
            text-align: center;
            border: 8px solid#0a4c72;
            border-style: double;
            border-radius: 8px;
        }

        .comment p {
            font-family: Caption;
            font-weight: 400;
            font-size: 16px;
            padding: 6px;
            text-align: center;
            color: #0a4c72;
            line-height: 120%;
        }

        .form {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .BG-Copy {
            font-size: 16px;
            border: 2px, solid, #0a4c72;
            border-radius: 4px;
            padding: 8px;
            margin: 4px;
        }

        #feedback {
            max-width: 95%;
        }

        .Base {
            position: absolute;
            right: 8px;
            bottom: -54px;
            width: 150px;
            height: 50px;
            font-size: 16px;
            border-radius: 4px;
            box-shadow: 2px 2px 0 0 rgba(157, 139, 127, 0.25);
            background-color: #0a4c72;
            color: white;
        }

        .Base:hover,
        .fa-solid:hover {
            cursor: pointer;
        }
        .reflesh{
            font-family: Caption;
            font-size: 16px;
            padding: 6px 0px 6px 0px;
            text-align: center;
            color:#2f3944;
}

        table {
            max-width: 600px;
            margin: 12px 0px 0px 0px;
            text-align: center;
            border: 2px solid #2f3944;
            font-family: Caption;
            font-size: 16px;
            border-collapse: collapse;
        }

        iframe {
            border-width: 0px 2px 2px 2px;
            border-style: solid;
            border-color: #2f3944;
        }

        th {
            background-color: rgb(10, 76, 114);
            border: 1px solid #2f3944;
            color: #fff;
            vertical-align: middle;
            /* 垂直置中 */
        }

        td {
            border: 1px solid rgb(47, 57, 68);
            background-color: #fff;
            vertical-align: middle;
            /* 垂直置中 */
            font-family: "Black Ops One", system-ui;
            font-size: 16px;
            color: rgba(47, 57, 68, 0.8);
            padding: 8px;
        }

        tr {
            height: 50px;
        }

        .wrap {
            position: relative;
        }

        .footer {
            position: absolute;
            bottom: 0px;
            width: 100%;
            height: 50px;
            background-color: #2f3944;
        }

        h4 {
            text-align: center;
            padding: 12px;
            font-family: "Black Ops One", system-ui;
            font-size: 12px;
        }

        .fa-solid {
            color: #0a4c72;
            font-size: 50px;
            position: fixed;
            right: 4px;
            bottom: 54px;
        }


        @media(max-width:829px) {
            .header {
                width: 100%;
                height: 100%;
            }
.ifram{
    width: 95%;
        }

        @media(max-width:768px) {
            .header {
                width: 100%;
                height: 100%;
            }

        }

        @media(max-width:431px) {
            h1 {
                text-align: left;
                padding-left: 2%;
                padding-right: 1%;
            }

            .form,
            .BG-Copy {
                max-width: 95%;
            }

            table {
                max-width: 100%;
                margin: 12px 2.5% 0px 2.5%;
            }
            iframe{
                max-width: 95%;
                margin: 0px 2.5% 12px 2.5%;
            }

            .footer {
                width: 100%;
            }
        }

        @media(max-width:360px) {
            h1 {
                text-align: left;
                padding-left: 2%;
                padding-right: 1%;
            }

            .form,
            .BG-Copy {
                max-width: 95%;
            }

            table {
                max-width: 100%;
                margin: 12px 2.5% 0px 2.5%;
            }
            iframe{
                max-width: 95%;
                margin: 0px 2.5% 12px 2.5%;
            }
            .footer {
                width: 100%;
            }
        }
    </style>

</head>

<body>
    <div class="wrap">
        <div class="header-bg">
            <h1>朋友啊，在沒有城牆的拂曉中再會吧。</h1>
            <div class="header">
                <p id="myElement1" class="animate__fadeInUp" style="display: none;">
                    艾爾文‧史密斯放棄了對他而言，比人類勝利更重要的真相，率領調查兵團為帕拉迪島闢出生路，時至今日，許多經歷殖民統治的國家也在解殖歷程中，為民族自決的勝利奮鬥，而抉擇是否要成為一名「惡魔」。</p>
                <P id="myElement2" class="animate__fadeInUp" style="display: none;">
                    在這條血路上，有無數未曾留名的夥伴犧牲，艾爾文作為團長雖然未能親眼見證，他英勇的士兵終究將獻出的心臟送達了真相的彼方。</P>
            </div>
        </div>
        <div class="comment-bg">
            <div class="comment">
                <h2>留 聲 機</h2>
                <p>十月十四日為歷史上所載艾爾文的生日，<br>歡迎留下您對他的祝福。</p>
                <!-- 輸入框 定義各個欄位form內容 -->
                <form id="myform" action="" method="post" class="form">
                    <INPUT TYPE="text" id="username" name="username" value="" placeholder="你的名字" class="BG-Copy"
                        autocomplete="name">
                    <TEXTAREA NAME="feedback" id="feedback" ROWS="5" COLS="62" placeholder="想說的話"
                        class="BG-Copy"></TEXTAREA>
                    <br>
                    <!-- 定義送出鍵的動作，使用JavaScript的function-->
                    <INPUT TYPE="submit" id="submitButton" VALUE="送出" class="Base">
                </form>
            </div>
        </div>
        <div class="result-bg">
            <div class="result">
                <h2>士 兵 的 聲 音</h2>
                <p class="reflesh">重整後顯示留聲內容</p>
                <!-- 表格定義 設定置中 -->
                <table id="Feedback_table">
                    <thead>
                        <tr>
                            <th width="130px">姓名</th>
                            <th width="320px">留聲內容</th>
                            <th width="150px">時間</th>
                        </tr>
                        <tr>
                            <td>Levi</td>
                            <td>O Captain, My Captain.</td>
                            <td>2024/10/14 上午0:00:00</td>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <iframe width="600" height="800"
                    src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQloyq0sMOCW9W9yvJNR8hR3Du9uXZKWMzEqe_gpVPGVyGMnT6aoEydF9IwVVqEUCx85g7dbSAbpHE3/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
            </div>
        </div>
        <div class="footer">
            <h4>©Erwin Foundation / Founder:zuo<br>For the celebration of October 14th, 2024.</h4>
        </div>
    </div>
    <div class="back">
        <i class="fa-solid fa-circle-up"></i>
    </div>
</body>
<!--引用js-->
<script src="js/jquery-3.7.1.min.js"></script>
<script src="js/messageboard.js"></script>
<!-- JavaScript程式 -->
<script>
    $(document).ready(function () {
        /*上捲*/
        $('.fa-solid').click(function (e) {
            e.preventDefault();
            $('html,body').animate({
                scrollTop: 0
            }, 700);
        });
    });
    $(document).ready(function () {
        // 當頁面加載時，設置 n 秒延遲後播放動畫
        setTimeout(function () {
            $("#myElement1").fadeIn().addClass("animate__fadeInUp");
        }, 500);
    });
    $(document).ready(function () {
        // 當頁面加載時，設置 n 秒延遲後播放動畫
        setTimeout(function () {
            $("#myElement2").fadeIn().addClass("animate__fadeInUp");
        }, 1700);
    });
    function submitData(event) {
        event.preventDefault(); // 阻止表單默認提交行為

        var username = document.getElementById("username").value;
        var feedback = document.getElementById("feedback").value;

        var data = {
            username: username,
            feedback: feedback
        };

        console.log("Submitting data:", data); // 輸出要提交的數據

        fetch("https://script.google.com/macros/s/AKfycbxIV0ERUsHpTqW5qNeTg26FzLfF5AfgqwQOc24JIGXh4u3aTI8RIIAGZwV4vpg5W6aH/exec", {
            method: "POST",
            body: JSON.stringify(data),
            mode: 'no-cors', // 加入這一行           
            headers: {
                "Content-Type": "application/json"
            }
        })
            .then(response => response.text())
            .then(responseData => {
                console.log(responseData);
            })
            .then(() => {
                alert("謝謝 " + username + "獻出的心臟"); // 顯示成功消息
                clearForm(); // 清空表單
                fetchData(); // 獲取並顯示最新數據
            })
            .catch(error => {
                console.error('Error:', error);
                alert("抱歉，判定為瑪雷人。請稍後再試。");
            });
    }

    function clearForm() {
        document.getElementById("username").value = '';
        document.getElementById("feedback").value = '';
    }

    function fetchData() {
        fetch("https://script.google.com/macros/s/AKfycbxIV0ERUsHpTqW5qNeTg26FzLfF5AfgqwQOc24JIGXh4u3aTI8RIIAGZwV4vpg5W6aH/exec")
            .then(response => response.json())
            .then(data => {
                const tableBody = document.getElementById('Feedback_table').querySelector('tbody');
                tableBody.innerHTML = ''; // 清空現有的內容

                data.forEach(row => {
                    const tr = document.createElement('tr');
                    row.forEach(cell => {
                        const td = document.createElement('td');
                        td.textContent = cell;
                        tr.appendChild(td);
                    });
                    tableBody.appendChild(tr);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    document.getElementById("myform").addEventListener("submit", submitData);
    // 初始獲取數據
    fetchData();


</script>

</html>
